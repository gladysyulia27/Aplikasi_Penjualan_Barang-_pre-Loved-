<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" th:replace="~{layout/base :: layout(~{::head}, ~{::content}, ~{::scripts})}">
<head th:fragment="head">
    <title th:text="${product.name + ' - Detail Produk'}">Detail Produk</title>
</head>
<body>
    <th:block th:fragment="content">
        <div class="row" th:if="${product != null}">
            <div class="col-md-6">
                <img th:src="${product.imageUrl != null ? product.imageUrl : '/images/placeholder.jpg'}" 
                     class="img-fluid rounded shadow" 
                     th:alt="${product.name}">
            </div>
            <div class="col-md-6">
                <div class="detail-content bg-primary text-white p-4 rounded shadow">
                    <h2 class="text-white mb-3" th:text="${product.name}">Nama Produk</h2>
                    <p class="text-white-50 mb-3" th:text="${product.description}">Deskripsi</p>
                    <div class="mb-3">
                        <span class="badge bg-white text-primary fs-6" th:text="${product.category}">Kategori</span>
                        <span class="badge bg-white text-primary fs-6 ms-2" th:text="${product.condition}">Kondisi</span>
                    </div>
                    <h3 class="text-white mb-4" th:text="'Rp ' + ${#numbers.formatDecimal(product.price, 0, 'COMMA', 0, 'POINT')}">Rp 0</h3>
                    <div class="mb-4">
                        <small class="text-white-50">
                            <i class="bi bi-calendar"></i> Ditambahkan: 
                            <span th:text="${#temporals.format(product.createdAt, 'dd MMMM yyyy')}">Tanggal</span>
                        </small>
                    </div>
                    <th:block th:if="${isOwner == true}">
                        <div class="btn-group" role="group">
                            <a th:href="@{/products/{id}/edit(id=${product.id})}" class="btn btn-warning">
                                <i class="bi bi-pencil"></i> Edit
                            </a>
                            <button type="button" class="btn btn-danger" onclick="deleteProduct('[[${product.id}]]')">
                                <i class="bi bi-trash"></i> Hapus
                            </button>
                        </div>
                    </th:block>
                    <th:block th:if="${isOwner != true}">
                        <button class="btn btn-light btn-lg">
                            <i class="bi bi-cart-plus"></i> Beli Sekarang
                        </button>
                    </th:block>
                </div>
            </div>
        </div>
    </th:block>
    <th:block th:fragment="scripts">
        <script>
            function deleteProduct(id) {
                if (confirm('Apakah Anda yakin ingin menghapus produk ini?')) {
                    fetch('/products/' + id + '/delete', {
                        method: 'POST'
                    })
                    .then(response => response.json())
                    .then(result => {
                        if (result.status === 'success') {
                            alert('Produk berhasil dihapus');
                            window.location.href = '/products';
                        } else {
                            alert('Error: ' + result.message);
                        }
                    });
                }
            }
        </script>
    </th:block>
</body>
</html>

